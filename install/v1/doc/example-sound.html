
	<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml">
	
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />	
		<title>V1 Script - Play Sound</title>
		<link rel="stylesheet" type="text/css" href="css/style.css" />
	</head>
	
	<body>
	
	<div class="logo"><a href="index.html"><img src="images/v1_logo.png" alt="V1 Script"/></a></div>
	
	<div class="page_wrap">
	<h1>Example: Play Sound</h1>
<p>Demonstrates how to play sound on Windows with <a href="module-sound.html">sound module</a>.</p>
<pre><code><span style="color: #000000"></span><span style="color: #0000BB;">&lt;?</span><span style="color: #000000">v1<br /><br />dl&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"sound"</span><span style="color: #0000BB;">);&nbsp;</span><span style="color: #008000">//&nbsp;Load&nbsp;sound&nbsp;module,&nbsp;only&nbsp;on&nbsp;Windows<br /><br />//&nbsp;Play&nbsp;WAV&nbsp;file<br /></span><span style="color: #0000BB;">print&nbsp;(</span><span style="color: #DD0000">"Play&nbsp;WAV&nbsp;file."</span><span style="color: #0000BB;">);<br /></span><span style="color: #000000">play_sound&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"sound.wav"</span><span style="color: #0000BB;">);<br /><br /></span><span style="color: #008000">//&nbsp;Play&nbsp;System&nbsp;sound<br /></span><span style="color: #0000BB;">print&nbsp;(</span><span style="color: #DD0000">"Play&nbsp;Windows&nbsp;system&nbsp;start&nbsp;sound&nbsp;asynchronous."</span><span style="color: #0000BB;">);<br /></span><span style="color: #000000">play_sound&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"SystemStart"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">SND_ALIAS</span><span style="color: #0000BB;">|</span><span style="color: #000000">SND_ASYNC</span><span style="color: #0000BB;">);<br /><br /></span><span style="color: #008000">//&nbsp;Play&nbsp;MIDI<br />//&nbsp;Note:&nbsp;Win7+&nbsp;has&nbsp;no&nbsp;default&nbsp;MIDI&nbsp;device!&nbsp;Please&nbsp;install&nbsp;MIDI&nbsp;device&nbsp;manually.<br />//&nbsp;For&nbsp;example:&nbsp;https://coolsoft.altervista.org/en/virtualmidisynth<br /></span><span style="color: #000000">deviceId&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">0</span><span style="color: #0000BB;">;<br /></span><span style="color: #000000">voice&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">1</span><span style="color: #0000BB;">;<br /></span><span style="color: #000000">volume&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">127</span><span style="color: #0000BB;">;<br /><br /></span><span style="color: #000000">freqList&nbsp;</span><span style="color: #0000BB;">=&nbsp;array&nbsp;(<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"c1"&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">264</span><span style="color: #0000BB;">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"d1"&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">297</span><span style="color: #0000BB;">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"e1"&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">330</span><span style="color: #0000BB;">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"f1"&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">352</span><span style="color: #0000BB;">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"g1"&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">396</span><span style="color: #0000BB;">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"a1"&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">440</span><span style="color: #0000BB;">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"h1"&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">495</span><span style="color: #0000BB;">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"c2"&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">528<br /></span><span style="color: #0000BB;">);<br />print&nbsp;(</span><span style="color: #DD0000">"Play&nbsp;MIDI&nbsp;notes."</span><span style="color: #0000BB;">);<br /><br /></span><span style="color: #000000">hMidi&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">midi_create&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">deviceId</span><span style="color: #0000BB;">);<br />if&nbsp;(!</span><span style="color: #000000">hMidi</span><span style="color: #0000BB;">)&nbsp;{<br />&nbsp;&nbsp;print&nbsp;(</span><span style="color: #DD0000">"No&nbsp;MIDI&nbsp;device&nbsp;found."</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;</span><span style="color: #008000">//&nbsp;Check&nbsp;Windows&nbsp;version&nbsp;&gt;=&nbsp;Win7<br />&nbsp;&nbsp;</span><span style="color: #0000BB;">if&nbsp;(</span><span style="color: #000000">version</span><span style="color: #0000BB;">(</span><span style="color: #000000">2</span><span style="color: #0000BB;">)&gt;=</span><span style="color: #000000">6</span><span style="color: #0000BB;">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(</span><span style="color: #DD0000">"Note:&nbsp;Your&nbsp;Windows&nbsp;version&nbsp;has&nbsp;no&nbsp;default&nbsp;MIDI&nbsp;device!&nbsp;Please&nbsp;install&nbsp;MIDI&nbsp;device&nbsp;manually.\r\nFor&nbsp;example:&nbsp;https://coolsoft.altervista.org/en/virtualmidisynth"</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;}<br />}<br />else&nbsp;{<br />&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #000000">freqList&nbsp;</span><span style="color: #0000BB;">as&nbsp;</span><span style="color: #000000">note&nbsp;</span><span style="color: #0000BB;">=&gt;&nbsp;</span><span style="color: #000000">freq</span><span style="color: #0000BB;">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(</span><span style="color: #DD0000">"Play&nbsp;Note:&nbsp;"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">note</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #DD0000">",&nbsp;Voice:&nbsp;"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">voice</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">midi_voice&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">hMidi</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">voice</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">midi_play&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">hMidi</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">midi_freq2note&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">freq</span><span style="color: #0000BB;">),&nbsp;</span><span style="color: #000000">volume</span><span style="color: #0000BB;">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">sleep&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">500</span><span style="color: #0000BB;">);&nbsp;</span><span style="color: #008000">//&nbsp;Play&nbsp;for&nbsp;500&nbsp;ms<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB;">if&nbsp;(</span><span style="color: #000000">note</span><span style="color: #0000BB;">!=</span><span style="color: #DD0000">"c2"</span><span style="color: #0000BB;">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">midi_play&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">hMidi</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">freq</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">volume</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">true</span><span style="color: #0000BB;">);&nbsp;</span><span style="color: #008000">//&nbsp;Stop/Mute&nbsp;the&nbsp;note,&nbsp;otherwise&nbsp;it&nbsp;will&nbsp;play&nbsp;forever<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">voice</span><span style="color: #0000BB;">++;<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;</span><span style="color: #000000">sleep&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">3000</span><span style="color: #0000BB;">);&nbsp;</span><span style="color: #008000">//&nbsp;Lets&nbsp;playout&nbsp;the&nbsp;last&nbsp;note<br />&nbsp;&nbsp;</span><span style="color: #000000">midi_close&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">hMidi</span><span style="color: #0000BB;">);<br />}<br /><br />print&nbsp;(</span><span style="color: #DD0000">"Stop&nbsp;asynchronous&nbsp;playing&nbsp;of&nbsp;play_sound()&nbsp;function."</span><span style="color: #0000BB;">);<br /></span><span style="color: #000000">sleep&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">1000</span><span style="color: #0000BB;">);<br /></span><span style="color: #000000">play_sound&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">null</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">0</span><span style="color: #0000BB;">);<br /><br /></span><span style="color: #000000">?&gt;</span></code></pre>
<p><a href="index.html">back to Home</a></p>
	</div>
	<footer>
		<p>V1 Version 0.96 - Documentation generated Sun, 04 Jun 2023 12:38</p>
	</footer>
	</body>
	</html>
	
	