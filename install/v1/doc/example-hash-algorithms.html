
	<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml">
	
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />	
		<title>V1 Script - Hash algorithms</title>
		<link rel="stylesheet" type="text/css" href="css/style.css" />
	</head>
	
	<body>
	
	<div class="logo"><a href="index.html"><img src="images/v1_logo.png" alt="V1 Script"/></a></div>
	
	<div class="page_wrap">
	<h1>Example: Hash algorithms</h1>
<p>Demonstrates how to work with hash algorithms in <a href="module-crypt.html">crypt module</a>. The crypt() function is full compatible with PHP <a href="http://php.net/manual/en/function.crypt.php" target="_blank">crypt ()</a>.</p>
<pre><code><span style="color: #000000"></span><span style="color: #0000BB;">&lt;?</span><span style="color: #000000">v1<br /><br />dl&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"crypt"</span><span style="color: #0000BB;">);&nbsp;</span><span style="color: #008000">//&nbsp;Load&nbsp;crypt&nbsp;module<br /><br />//&nbsp;Function&nbsp;to&nbsp;create&nbsp;random&nbsp;strings<br /></span><span style="color: #0000BB;">function&nbsp;</span><span style="color: #000000">getRandomString&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">max</span><span style="color: #0000BB;">=</span><span style="color: #000000">22</span><span style="color: #0000BB;">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000">//&nbsp;Initialize&nbsp;the&nbsp;random&nbsp;timer<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">srand&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">microtime&nbsp;</span><span style="color: #0000BB;">());<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">str&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #0000BB;">;<br />&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</span><span style="color: #000000">j&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">0</span><span style="color: #0000BB;">;&nbsp;</span><span style="color: #000000">j&nbsp;</span><span style="color: #0000BB;">&lt;&nbsp;</span><span style="color: #000000">max</span><span style="color: #0000BB;">;&nbsp;</span><span style="color: #000000">j</span><span style="color: #0000BB;">++)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">str</span><span style="color: #0000BB;">.=</span><span style="color: #000000">substr</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">rand</span><span style="color: #0000BB;">()%</span><span style="color: #000000">64</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">1</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #000000">str</span><span style="color: #0000BB;">;<br />}<br /><br /></span><span style="color: #000000">text&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #DD0000">"String&nbsp;to&nbsp;hash"</span><span style="color: #0000BB;">;<br /><br /></span><span style="color: #008000">//&nbsp;DES&nbsp;need&nbsp;a&nbsp;2&nbsp;byte&nbsp;salt<br /></span><span style="color: #000000">salt&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">getRandomString</span><span style="color: #0000BB;">(</span><span style="color: #000000">2</span><span style="color: #0000BB;">);<br />print&nbsp;(</span><span style="color: #DD0000">"DES&nbsp;crypt()&nbsp;=&nbsp;"</span><span style="color: #0000BB;">.</span><span style="color: #000000">crypt</span><span style="color: #0000BB;">(</span><span style="color: #000000">text</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">salt</span><span style="color: #0000BB;">));<br /><br /></span><span style="color: #008000">//&nbsp;If&nbsp;no&nbsp;salt&nbsp;is&nbsp;given&nbsp;then&nbsp;MD5&nbsp;with&nbsp;random&nbsp;salt&nbsp;is&nbsp;chosen<br /></span><span style="color: #0000BB;">print&nbsp;(</span><span style="color: #DD0000">"MD5&nbsp;crypt()&nbsp;=&nbsp;"</span><span style="color: #0000BB;">.</span><span style="color: #000000">crypt</span><span style="color: #0000BB;">(</span><span style="color: #000000">text</span><span style="color: #0000BB;">));<br /><br /></span><span style="color: #000000">salt&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #DD0000">'$2y$07$'</span><span style="color: #0000BB;">.</span><span style="color: #000000">getRandomString</span><span style="color: #0000BB;">();<br />print&nbsp;(</span><span style="color: #DD0000">"Blowfish&nbsp;crypt()&nbsp;=&nbsp;"</span><span style="color: #0000BB;">.</span><span style="color: #000000">crypt</span><span style="color: #0000BB;">(</span><span style="color: #000000">text</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">salt</span><span style="color: #0000BB;">));<br /><br /></span><span style="color: #000000">salt&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #DD0000">'$5$rounds=5000$'</span><span style="color: #0000BB;">.</span><span style="color: #000000">getRandomString</span><span style="color: #0000BB;">(</span><span style="color: #000000">5</span><span style="color: #0000BB;">).</span><span style="color: #DD0000">'$'</span><span style="color: #0000BB;">;<br />print&nbsp;(</span><span style="color: #DD0000">"SHA256&nbsp;crypt()&nbsp;=&nbsp;"</span><span style="color: #0000BB;">.</span><span style="color: #000000">crypt</span><span style="color: #0000BB;">(</span><span style="color: #000000">text</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">salt</span><span style="color: #0000BB;">));&nbsp;&nbsp;<br /><br /></span><span style="color: #000000">salt&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #DD0000">'$6$rounds=5000$'</span><span style="color: #0000BB;">.</span><span style="color: #000000">getRandomString</span><span style="color: #0000BB;">(</span><span style="color: #000000">5</span><span style="color: #0000BB;">).</span><span style="color: #DD0000">'$'</span><span style="color: #0000BB;">;<br />print&nbsp;(</span><span style="color: #DD0000">"SHA512&nbsp;crypt()&nbsp;=&nbsp;"</span><span style="color: #0000BB;">.</span><span style="color: #000000">crypt</span><span style="color: #0000BB;">(</span><span style="color: #000000">text</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">salt</span><span style="color: #0000BB;">));&nbsp;&nbsp;<br /><br /></span><span style="color: #008000">//&nbsp;Print&nbsp;integrated&nbsp;hash&nbsp;algorithms<br /></span><span style="color: #000000">print_r&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">hash_algos&nbsp;</span><span style="color: #0000BB;">());<br /><br /></span><span style="color: #008000">//&nbsp;Calculate&nbsp;hash&nbsp;of&nbsp;a&nbsp;complete&nbsp;file<br /></span><span style="color: #0000BB;">print&nbsp;(</span><span style="color: #DD0000">"SHA256&nbsp;of&nbsp;file&nbsp;v1.exe:&nbsp;"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">hash_file&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"sha256"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #DD0000">"v1.exe"</span><span style="color: #0000BB;">));<br /><br /></span><span style="color: #000000">?&gt;</span></code></pre>
<p><a href="index.html">back to Home</a></p>
	</div>
	<footer>
		<p>V1 Version 0.96 - Documentation generated Tue, 05 Sep 2023 11:27</p>
	</footer>
	</body>
	</html>
	
	