
	<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml">
	
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />	
		<title>V1 Script - SQLite3</title>
		<link rel="stylesheet" type="text/css" href="css/style.css" />
	</head>
	
	<body>
	
	<div class="logo"><a href="index.html"><img src="images/v1_logo.png" alt="V1 Script"/></a></div>
	
	<div class="page_wrap">
	<h1>Example: Work with SQLite3 databases</h1>
<p>Demonstrates how to work with SQLlite3 databases.<br>
SQLite3 functions are defined in <strong>lib/sqlite3.inc.v1</strong></p>
<p>Note: You have to install SQLite3 libraries.
On Windows copy the 32-Bit DLL sqlite3.dll into the home directory of V1 where v1.exe is located.</p>
<p><a href="https://www.sqlite.org/download.html" target="_blank">https://www.sqlite.org/download.html</a></p>
<pre><code><span style="color: #000000"></span><span style="color: #0000BB;">&lt;?</span><span style="color: #000000">v1<br /></span><span style="color: #0000BB;">require_once&nbsp;(</span><span style="color: #DD0000">"lib/sqlite3.inc.v1"</span><span style="color: #0000BB;">);<br /><br /></span><span style="color: #008000">//&nbsp;Open&nbsp;database<br /></span><span style="color: #000000">db&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">null</span><span style="color: #0000BB;">;<br /></span><span style="color: #000000">sqlite3_open&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"test.db"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">db</span><span style="color: #0000BB;">);<br />if&nbsp;(!</span><span style="color: #000000">db</span><span style="color: #0000BB;">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(</span><span style="color: #DD0000">"Cannot&nbsp;open&nbsp;database"</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;(</span><span style="color: #000000">1</span><span style="color: #0000BB;">);<br />}<br /><br /></span><span style="color: #008000">//&nbsp;Insert&nbsp;data<br /></span><span style="color: #000000">sql&nbsp;</span><span style="color: #0000BB;">=&nbsp;<br /></span><span style="color: #DD0000">"DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;Cars;"</span><span style="color: #0000BB;">.&nbsp;<br /></span><span style="color: #DD0000">"CREATE&nbsp;TABLE&nbsp;Cars(Id&nbsp;INT,&nbsp;Name&nbsp;TEXT,&nbsp;Price&nbsp;INT);"</span><span style="color: #0000BB;">.<br /></span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;Cars&nbsp;VALUES(1,&nbsp;'Audi',&nbsp;52642);"</span><span style="color: #0000BB;">.&nbsp;<br /></span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;Cars&nbsp;VALUES(2,&nbsp;'Mercedes',&nbsp;57127);"</span><span style="color: #0000BB;">.&nbsp;<br /></span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;Cars&nbsp;VALUES(3,&nbsp;'Skoda',&nbsp;9000);"</span><span style="color: #0000BB;">.&nbsp;<br /></span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;Cars&nbsp;VALUES(4,&nbsp;'Volvo',&nbsp;29000);"</span><span style="color: #0000BB;">.&nbsp;<br /></span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;Cars&nbsp;VALUES(5,&nbsp;'Bentley',&nbsp;350000);"</span><span style="color: #0000BB;">.&nbsp;<br /></span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;Cars&nbsp;VALUES(6,&nbsp;'Citroen',&nbsp;21000);"</span><span style="color: #0000BB;">.&nbsp;<br /></span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;Cars&nbsp;VALUES(7,&nbsp;'Hummer',&nbsp;41400);"</span><span style="color: #0000BB;">.&nbsp;<br /></span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;Cars&nbsp;VALUES(8,&nbsp;'Volkswagen',&nbsp;21600);"</span><span style="color: #0000BB;">;<br /><br /></span><span style="color: #000000">err_msg&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #0000BB;">;<br /></span><span style="color: #000000">rc&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">sqlite3_exec&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">db</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">sql</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">null</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">null</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">err_msg</span><span style="color: #0000BB;">);<br />print&nbsp;(</span><span style="color: #DD0000">"Last&nbsp;rowid&nbsp;=&nbsp;"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">sqlite3_last_insert_rowid&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">db</span><span style="color: #0000BB;">));<br /><br />if&nbsp;(</span><span style="color: #000000">rc&nbsp;</span><span style="color: #0000BB;">!=&nbsp;</span><span style="color: #000000">SQLITE_OK&nbsp;</span><span style="color: #0000BB;">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(&nbsp;</span><span style="color: #DD0000">"Error&nbsp;("</span><span style="color: #0000BB;">.</span><span style="color: #000000">rc</span><span style="color: #0000BB;">.</span><span style="color: #DD0000">"):"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">err_msg</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">sqlite3_close</span><span style="color: #0000BB;">(</span><span style="color: #000000">db</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;(</span><span style="color: #000000">1</span><span style="color: #0000BB;">);<br />}&nbsp;<br /><br /></span><span style="color: #008000">//&nbsp;Select&nbsp;data&nbsp;with&nbsp;prepared&nbsp;statement<br /></span><span style="color: #000000">stmt&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">0</span><span style="color: #0000BB;">;<br /></span><span style="color: #000000">sql&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;Id,&nbsp;Name,&nbsp;Price&nbsp;FROM&nbsp;Cars&nbsp;WHERE&nbsp;Id&nbsp;=&nbsp;@id"</span><span style="color: #0000BB;">;<br /><br /></span><span style="color: #000000">rc&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">sqlite3_prepare&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">db</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">sql</span><span style="color: #0000BB;">,&nbsp;-</span><span style="color: #000000">1</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">stmt</span><span style="color: #0000BB;">);<br />if&nbsp;(</span><span style="color: #000000">rc&nbsp;</span><span style="color: #0000BB;">==&nbsp;</span><span style="color: #000000">SQLITE_OK</span><span style="color: #0000BB;">)&nbsp;<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">paramIdx&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">sqlite3_bind_parameter_index&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">stmt</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #DD0000">"@id"</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">sqlite3_bind_int&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">stmt</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">paramIdx</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">3</span><span style="color: #0000BB;">);&nbsp;</span><span style="color: #008000">//&nbsp;Bind&nbsp;integer&nbsp;value&nbsp;3&nbsp;to&nbsp;parameter<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Print&nbsp;column&nbsp;names<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">colCnt&nbsp;</span><span style="color: #0000BB;">=&nbsp;</span><span style="color: #000000">sqlite3_column_count&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">stmt</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</span><span style="color: #000000">i</span><span style="color: #0000BB;">=</span><span style="color: #000000">0</span><span style="color: #0000BB;">;</span><span style="color: #000000">i</span><span style="color: #0000BB;">&lt;</span><span style="color: #000000">colCnt</span><span style="color: #0000BB;">;</span><span style="color: #000000">i</span><span style="color: #0000BB;">++)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">printf</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"%s|"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">sqlite3_column_name&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">stmt</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">i</span><span style="color: #0000BB;">));<br />&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(</span><span style="color: #DD0000">"\r\n"</span><span style="color: #0000BB;">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000">//&nbsp;Print&nbsp;rows<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB;">while&nbsp;(</span><span style="color: #000000">sqlite3_step</span><span style="color: #0000BB;">(</span><span style="color: #000000">stmt</span><span style="color: #0000BB;">)&nbsp;!=&nbsp;</span><span style="color: #000000">SQLITE_DONE</span><span style="color: #0000BB;">)&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</span><span style="color: #000000">i</span><span style="color: #0000BB;">=</span><span style="color: #000000">0</span><span style="color: #0000BB;">;</span><span style="color: #000000">i</span><span style="color: #0000BB;">&lt;</span><span style="color: #000000">colCnt</span><span style="color: #0000BB;">;</span><span style="color: #000000">i</span><span style="color: #0000BB;">++)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">printf</span><span style="color: #0000BB;">(</span><span style="color: #DD0000">"%s|"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">sqlite3_column_text&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">stmt</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">i</span><span style="color: #0000BB;">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(</span><span style="color: #DD0000">"\r\n"</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;<br />}<br />else&nbsp;{&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(&nbsp;</span><span style="color: #DD0000">"Error&nbsp;("</span><span style="color: #0000BB;">.</span><span style="color: #000000">rc</span><span style="color: #0000BB;">.</span><span style="color: #DD0000">"):"</span><span style="color: #0000BB;">,&nbsp;</span><span style="color: #000000">sqlite3_errmsg</span><span style="color: #0000BB;">(</span><span style="color: #000000">db</span><span style="color: #0000BB;">));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">sqlite3_close</span><span style="color: #0000BB;">(</span><span style="color: #000000">db</span><span style="color: #0000BB;">);<br />&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;(</span><span style="color: #000000">1</span><span style="color: #0000BB;">);<br />}<br /><br /></span><span style="color: #000000">sqlite3_finalize&nbsp;</span><span style="color: #0000BB;">(</span><span style="color: #000000">stmt</span><span style="color: #0000BB;">);<br /></span><span style="color: #000000">sqlite3_close</span><span style="color: #0000BB;">(</span><span style="color: #000000">db</span><span style="color: #0000BB;">);<br /><br /></span><span style="color: #000000">?&gt;</span></code></pre>
<p><a href="index.html">back to Home</a></p>
	</div>
	<footer>
		<p>V1 Version 0.96 - Documentation generated Sun, 27 Aug 2023 15:40</p>
	</footer>
	</body>
	</html>
	
	